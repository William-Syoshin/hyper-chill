# マイグレーション実行手順

## 重要：データベースマイグレーションを実行してください

事前登録機能を使用するには、データベースに `entrance` 会場を追加する必要があります。

## 手順

### 方法1: Supabaseダッシュボードで実行

1. Supabaseダッシュボードにログイン
   https://app.supabase.com/

2. プロジェクトを選択

3. 左サイドバーから「SQL Editor」をクリック

4. 新しいクエリを作成し、以下のSQLを実行：

```sql
-- 事前登録用の「entrance」会場を追加
INSERT INTO venues (id, name) VALUES
  ('entrance', 'ENTRANCE')
ON CONFLICT (id) DO NOTHING;
```

5. 「Run」ボタンをクリックして実行

### 方法2: Supabase CLIを使用（推奨）

```bash
# Supabase CLIをインストール（まだの場合）
npm install -g supabase

# プロジェクトとリンク
supabase link --project-ref your-project-ref

# マイグレーションを実行
supabase db push
```

## 確認方法

マイグレーションが成功したか確認するには：

1. Supabaseダッシュボードの「Table Editor」を開く
2. `venues` テーブルを選択
3. 以下の4つの会場が存在することを確認：
   - homeplanet
   - movement
   - astro
   - **entrance** ← 新しく追加

## トラブルシューティング

### 「チェックインに失敗しました」エラーが出る場合

原因：`entrance` 会場がデータベースに存在しない

解決策：上記のマイグレーションを実行してください

### 「無効な会場IDです」エラーが出る場合

原因：バリデーションエラー

確認事項：
1. `/pre-register` ページにアクセスできるか
2. ブラウザのコンソールエラーを確認

### デバッグ方法

ブラウザの開発者ツールを開いて（F12キー）、Consoleタブでエラーメッセージを確認してください。

## マイグレーション後の確認

マイグレーション実行後、以下をテストしてください：

1. `/pre-register` にアクセス → 事前登録フォームが表示される
2. フォームを入力して送信 → 「事前登録が完了しました！」と表示される
3. 会場QRコードをスキャン → 簡易チェックインフォームが表示される
4. チェックインボタンを押す → 成功メッセージが表示される

## お問い合わせ

問題が解決しない場合は、以下の情報と一緒にお知らせください：
- どのページでエラーが発生するか
- ブラウザのコンソールに表示されるエラーメッセージ
- マイグレーションを実行したかどうか



